<pre>
  NEP: 31
  Title: Contract destroy guideline
  Author: Owen Zhang <zhangzhihong@ngd.neo.org>
  Type: Standard
  Status: Draft
  Created: 2024-09-11
</pre>

==Abstract==

This proposal standardizes the destroy function which is necessary for contract storage deletion and contract disposal from the system.

==Motivation==

Contracts that are not relevant anymore may need to be destroyed. Neo N3 has provided contract destroy mechanism but it hasn't been summarized in a standard. This standard will show details.

==Specification==

Neo N3 has the native <code>ContractManagement</code> contract that is responsible for contract destruction via its <code>destroy</code> method. When <code>destroy</code> is executed, it will delete all storage entries of calling contract. It will block the calling contract address using the native <code>Policy</code> contract to prevent redeployment or calling any methods on the contract from that point forward. Contracts that want to be destroyable SHOULD implement the <code>destroy</code> method as described below.

===Methods===

====destroy====

<pre>
{
  "name": "destroy",
  "safe": false,
  "parameters": [],
  "returntype": "Void"
}
</pre>
This method MUST invoke the <code>destroy</code> method of <code>ContractManagement</code> contract when the contract is destroyed.

===Events===

====Destroy====

<pre>
{
  "name": "Destroy",
  "parameters": [
    {
      "name": "contract",
      "type": "Hash160"
    }
  ]
}
</pre>

<code>Destroy</code> notification is emitted automatically by native <code>ContractManagement</code> contract after all contract storage items and the contract itself are removed. This event contains destroyed contract hash.

==References==


==Implementation==

* C#: https://github.com/neo-project/neo-devpack-dotnet/blob/003a50095efe88f63f518a0c989921be086409f3/examples/Example.SmartContract.NFT/Loot.Admin.cs#L79

